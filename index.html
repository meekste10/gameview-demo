<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>FunBall ‚Äî Ball Telemetry Demo</title>
<style>
:root {
  --bg: #101820;
  --field1: #0b6623;
  --field2: #0a4f1a;
  --ball: #ffd97a;
}
*{box-sizing:border-box;margin:0;padding:0}
body {
  background: var(--bg);
  color: #fff;
  font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  display: flex; flex-direction: column;
  align-items: center;
  min-height: 100vh;
  justify-content: center;
}
h1 { font-size: 1.4rem; margin-bottom: 8px; }
#canvasWrap {
  border: 2px solid #333;
  border-radius: 8px;
  background: linear-gradient(90deg, var(--field1) 50%, var(--field2) 50%);
  position: relative;
  width: 95vw;
  max-width: 800px;
  aspect-ratio: 120 / 53.333; /* yards field aspect */
}
canvas {
  width: 100%;
  height: 100%;
  display: block;
}
#hud {
  margin-top: 10px;
  opacity: 0.8;
  font-size: 0.9rem;
}
</style>
</head>
<body>
  <h1>üèà FunBall ‚Äî Ball Telemetry</h1>
  <div id="canvasWrap">
    <canvas id="funCanvas" width="1200" height="533"></canvas>
  </div>
  <div id="hud">Loading...</div>

<script>
(async () => {
  const hud = document.getElementById("hud");
  const canvas = document.getElementById("funCanvas");
  const ctx = canvas.getContext("2d");

  // Load telemetry
  let data;
  try {
    const res = await fetch("funball.json", {cache: "no-cache"});
    data = await res.json();
  } catch (err) {
    hud.textContent = "‚ùå Could not load funball.json";
    console.error(err);
    return;
  }

  const frames = data.frames || [];
  const fps = data.fps || 10;
  const tick = 1000 / fps;
  let frame = 0;

  // Draw helper
  function drawBall(x, y, z) {
    const w = canvas.width;
    const h = canvas.height;
    const px = (x / 120) * w;
    const py = h - (y / 53.333) * h;
    const radius = 8 + z * 4;

    // Trail
    ctx.fillStyle = "rgba(255,217,122,0.15)";
    ctx.beginPath();
    ctx.arc(px, py, radius * 2.5, 0, Math.PI * 2);
    ctx.fill();

    // Main ball
    ctx.fillStyle = "var(--ball)";
    ctx.beginPath();
    ctx.arc(px, py, radius, 0, Math.PI * 2);
    ctx.fill();
  }

  function drawFrame() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    const f = frames[frame];
    if (!f) return;

    const { x, y, z } = f.ball;
    drawBall(x, y, z);

    hud.textContent = `Frame ${frame + 1}/${frames.length} ‚Äî t=${f.time_s.toFixed(2)}s`;
    frame = (frame + 1) % frames.length;
  }

  function loop() {
    drawFrame();
    setTimeout(loop, tick);
  }

  hud.textContent = `‚úÖ Loaded ${frames.length} frames`;
  loop();
})();
</script>
</body>
</html>
